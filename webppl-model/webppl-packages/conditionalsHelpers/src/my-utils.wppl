/**
* negates a given variable using '-' as negation sign (e.g. -A -> A and A -> -A)
* @param {string} v
* @return {string}
*/
var negate = function(v){
  return v.startsWith("-") ? v.slice(1) : "-" + v
}

/**
* computes powerset of input strings
* @param {Array.<Array.<string>>} vars one array for each variable containing
* pos and possibly neg tokens, e.g. [["A", "-A"], ["C", "-C"]]
* @param {boolean} include_empty_set
* @return {Array.<Array.<string>>}
*/
var get_var_powerset = function(vars, include_empty_set){
  var powerset = Infer({model:function(){
                  var bools = repeat(vars.length, flip)
                  var tokens = mapIndexed(function(idx, b){
                    b ? uniformDraw(vars[idx]) : ""
                  }, bools)
                  return filter(function(t){t.length>0}, tokens)
                }}).support()
  include_empty_set ? powerset : filter(function(s){s.length > 0}, powerset)
}

/**
* computes elements that are in each of input arrays
* @param {Array.<Array>} arrays
* @return {Array} containig all shared elements
*/
var intersect_arrays = function(arrays){
  return filter(function(m){
          var m_in_all_lists = map(function(idx){arrays[idx].indexOf(m) != -1},
                                  _.range(1,arrays.length))
          return sum(m_in_all_lists)==m_in_all_lists.length
    }, arrays[0])
}

var round_two_digits = function(x){
  return(Math.round(x * 100) / 100)
}


var display_free_params = function(speaker_type){
  display("free parameters:")
  display("alpha: " + round_two_digits(globalStore.alpha) +
    " gamma: " + round_two_digits(globalStore.gamma) +
    " theta: " + round_two_digits(globalStore.thresholds.theta) +
    " theta_might: " + round_two_digits(globalStore.thresholds.theta_might))
  display("COST: both: " + round_two_digits(globalStore.utt_cost['C and A']) +
    " Â¬blue: " + round_two_digits(globalStore.utt_cost['-A']) +
    " blue: " + round_two_digits(globalStore.utt_cost['A']) +
    " if b,g: " + round_two_digits(globalStore.utt_cost['A > C']) +
    " might blue: " + round_two_digits(globalStore.utt_cost['might A']))
  display("# utts: " + globalStore.utterances.length)
  display("speaker model: " + speaker_type)
}
